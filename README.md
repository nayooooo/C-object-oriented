# C语言实现面向对象 #

探索C语言实现面向对象的过程是非常有趣的，在探索的过程中同时加深了自己对C语言的理解，因此想将自己的探索结果分享出来。

# 工程架构——CMake #

使用CMake工程架构，编译运行命令在`../build.bat`中，也就是说可以在工程目录下，输入`./build.bat`进行编译运行。

# 面向对象的实现 #

## 私有成员 ##

私有成员是不能在对象外部进行访问的，怎么来实现呢？我想到了联合体中的成员占据一片相同的空间，因此可以使用联合体进行可见性的选择。

    /* public struct -------------------------------------*/

	typedef struct Class_Struct{
	    uint8_t *name;
	
	    uint8_t *(*Get_Name)(struct Class_Struct const *const cp);
	}Class_Typedef;
	
	/* private struct ------------------------------------*/
	
	typedef struct{
	    union{
	        Class_Typedef public_Class_Object;
	        void *intro;
	    };
	
	    uint8_t age;
	}Class_Internal;

如上，在结构体`Class_Internal`中嵌入了一个联合体，联合体中第一个成员是`Class_Typedef`类型，我将其看作是类中的公共成员，可以直接在对象外面访问，而这个结构体其它成员则看作类中的私有成员，不能在外部进行访问，只有在这个类的文件中才能使用，因此要将`Class_Internal`放在`.c`文件中定义，一般不会引入`.c`文件，因此就无法在外部访问私有成员。

## 构造和析构 ##

构造和析构实现起来比较简单，构造只需要使用malloc之后初始化完成后加上构造函数部分就行了，析构同理。

## 封装 ##

类的封装的实现方式是每创建一个类就写对应的`.c .h`两个文件。

## 继承 ##

通过导入需要继承的类的头文件并在自己的类中创建一个父类对象继承。

## 多态 ##

多态指的是能够根据对象的不同类型调用同一个接口，实现不同的功能。

暂时没有实现……

## 注意点 ##

### 对象指针类型的转换 ###

由于C语言并不支持面向对象，我的实现方法是转换指针类型从而使私有成员公开，因此有一个数据类型转换的过程，试想一下，如果我们需要更改成员的可见性，就需要更改所有使用到这个成员的地方，不利于维护。此时应该想到运用宏，将修改范围缩小到宏定义一处。

# 探索历程 #

1. 实现了对象的构造和创建对象中的私有成员		--2022.08.08--
2. 实现了对象的析构		--2022.08.09--
3. 实现了对象的封装		--2022.08.09--
4. 实现了对象的继承		--2022.08.10--
5. 修复了析构函数的致命错误		--2022.08.10--
